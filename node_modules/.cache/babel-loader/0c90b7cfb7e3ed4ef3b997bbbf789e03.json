{"ast":null,"code":"'use strict';\n/*!\n * ignore\n */\n\nconst MongooseMap = require('../types/map');\n\nconst SchemaType = require('../schematype');\n/*!\n * ignore\n */\n\n\nclass Map extends SchemaType {\n  constructor(key, options) {\n    super(key, options, 'Map');\n    this.$isSchemaMap = true;\n  }\n\n  cast(val, doc, init) {\n    if (val instanceof MongooseMap) {\n      return val;\n    }\n\n    if (init) {\n      const map = new MongooseMap({}, this.path, doc, this.$__schemaType);\n\n      if (val instanceof global.Map) {\n        for (const key of val.keys()) {\n          map.$init(key, map.$__schemaType.cast(val.get(key), doc, true));\n        }\n      } else {\n        for (const key of Object.keys(val)) {\n          map.$init(key, map.$__schemaType.cast(val[key], doc, true));\n        }\n      }\n\n      return map;\n    }\n\n    return new MongooseMap(val, this.path, doc, this.$__schemaType);\n  }\n\n}\n\nmodule.exports = Map;","map":null,"metadata":{},"sourceType":"script"}